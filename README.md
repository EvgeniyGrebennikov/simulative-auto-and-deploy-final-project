## Автоматизация обработки данных магазина ##
### <b><i> Задание </i></b> ###
Необходимо написать скрипт, который генерирует N (кол-во магазинов) выгрузок в формате csv в папку <b><i> data/ </i></b>. Формат выгрузки будет указан ниже. 

Автоматизируйте этот скрипт так, чтобы он работал каждый день, кроме воскресенья. Вы можете это сделать с помощью того инструмента, который вам удобен - cron или планировщик Windows (зависит от вашей операционной системы).

Создайте базу данных для хранения этих данных.

Напишите скрипт, который будет забирать данные из этой папки и заносить их в базу данных. Учтите, что в папке могут находиться и лишние файлы - игнорируйте их.

Автоматизируйте этот скрипт, чтобы он работал каждый день.

Файлы с выгрузками должны называться <b><i> {{shop_num}}_{{cash_num}}.csv </i></b>. Здесь <b><i> {{shop_num}} </i></b> - номер магазина, а <b><i> {{cash_num}} </i></b> - номер кассы. В одном магазине может быть много касс - у каждой своя выгрузка. Пример названия: <b><i> 11_2.csv </i></b> - 11 магазин, 2 касса.

Формат выгрузки:
- <b> doc_id </b> - численно-буквенный идентификатор чека;
- <b> item </b> - название товара;
- <b> category </b> - категория товара (бытовая химия, текстиль, посуда и т.д.);
- <b> amount </b> - кол-во товара в чеке;
- <b> price </b> - цена одной позиции без учета скидки;
- <b> discount </b> - сумма скидки на эту позицию (может быть 0).

<b> Итоговая база данных </b>

   <img width="302" alt="scheme_shops_db" src="https://github.com/user-attachments/assets/c04fc89c-c77f-498b-8fd7-9f689a1d0671" />
   

### <b><i> Структура проекта </i></b> ###
Данный проект содержит следующие файлы:
- <b> cash_receipts_gen.py </b> - содержит скрипт генерации кассовых чеков магазинов (случайным образом определяется кол-во чеков за день и проданных позиций в чеке, кол-во рабочих касс магазина, id чека). <n>  
Также случайным образом определяются товары из файла <b><i> products.csv </i></b>, по которым были продажи. <n>
По результату работы скрипта генерируюся кассовые чеки, которые записываются в папку <b><i> data/ </i></b>;
- <b> data_processing_func.py </b> - скрипт содержит функцию <b><i> create_cash_receipts_df </i></b>, которая считывает данные по сгенерированным чекам из папки <b><i> data/ </i></b> и записывает результат общий датафрейм для последующей с ним работы. <n>
Функция <b><i> return_categories_and_products </i></b> считывает из файла <b><i> products.csv </i></b> данные по текущим товарам и категориям и возвращает список уникальных элементов, которые затем будут записаны в таблицы БД <b><i> catagories </i></b> и <b><i> products </i></b>;
- <b> pg_db_connector.py </b> - скрипт для подключения к базе данных. Содержит конструктор класса и метод post для загрузки данных в таблицу. <n> Также реализовано логгирование для отслеживания корректной загрузки данных в таблицы. Логи записываются в папку <b><i> logs/ </i></b>;
- <b> run_etl.py </b> - скрипт для записи данных в БД. После загрузки данных происходит удаление csv-файлов в папке <b><i> data/ </i></b>;
- <b> config.ini </b> - файл с настройками скрипта. Указан путь для записи csv-файлов и логов, также указан пример доступов к базе данных (для подключения и записи данных);
- <b> requirements.txt </b> - файл с установленными библиотеками, необходимыми для работы программы.

### <b><i> Запуск проекта </i></b> ###
Для запуска проекта необходимо загрузить репозиторий на свой компьютер:

     git clone https://github.com/EvgeniyGrebennikov/simulative-auto-and-deploy-final-project.git

Далее установить используемые в проекте библиотеки из файла <b><i> requirements.txt </i></b>:

     pip install -r requirements.txt
В файле <b><i> config.ini </i></b> необходимо указать актуальные доступы для подключения к своей базе данных и последующей записи данных: <b><i> HOST, PORT, USER, PASSWORD </i></b>.

Скрипт на создание таблиц БД находится в <b><i> sql/create_shops_db.sql </i></b>.

Далее необходимо запустить файл <b><i> cash_receipts_gen.py </i></b> для генерации кассовых чеков.

По итогу добавления чеков в папку <b><i> data/ </i></b> и создания таблиц в БД запустить скрипт <b><i> run_etl.py </i></b>
